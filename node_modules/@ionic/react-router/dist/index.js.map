{"version":3,"file":"index.js","sources":["../src/ReactRouter/IonRouteInner.tsx","../src/ReactRouter/ReactRouterViewStack.tsx","../src/ReactRouter/clonePageElement.ts","../src/ReactRouter/StackManager.tsx","../src/ReactRouter/IonRouter.tsx","../src/ReactRouter/IonReactRouter.tsx","../src/ReactRouter/IonReactMemoryRouter.tsx","../src/ReactRouter/IonReactHashRouter.tsx"],"sourcesContent":["import { IonRouteProps } from '@ionic/react';\nimport React from 'react';\nimport { Route } from 'react-router';\n\nexport class IonRouteInner extends React.PureComponent<IonRouteProps> {\n  render() {\n    return (\n      <Route path={this.props.path} exact={this.props.exact} render={this.props.render} computedMatch={(this.props as any).computedMatch} />\n    );\n  }\n}\n","import { IonRoute, RouteInfo, ViewItem, ViewLifeCycleManager, ViewStacks, generateId } from '@ionic/react';\nimport React from 'react';\nimport { matchPath } from 'react-router';\n\nexport class ReactRouterViewStack extends ViewStacks {\n\n  constructor() {\n    super();\n    this.createViewItem = this.createViewItem.bind(this);\n    this.findViewItemByRouteInfo = this.findViewItemByRouteInfo.bind(this);\n    this.findLeavingViewItemByRouteInfo = this.findLeavingViewItemByRouteInfo.bind(this);\n    this.getChildrenToRender = this.getChildrenToRender.bind(this);\n    this.getViewItemForTransition = this.getViewItemForTransition.bind(this);\n  }\n\n  createViewItem(outletId: string, reactElement: React.ReactElement, routeInfo: RouteInfo, page?: HTMLElement) {\n    const viewItem: ViewItem = {\n      id: generateId('viewItem'),\n      outletId,\n      ionPageElement: page,\n      reactElement,\n      mount: true,\n      ionRoute: false\n    };\n\n    const matchProps = {\n      exact: reactElement.props.exact,\n      path: reactElement.props.path || reactElement.props.from,\n      component: reactElement.props.component\n    };\n\n    const match = matchPath(routeInfo.pathname, matchProps);\n\n    if (reactElement.type === IonRoute) {\n      viewItem.ionRoute = true;\n      viewItem.disableIonPageManagement = reactElement.props.disableIonPageManagement;\n    }\n\n    viewItem.routeData = {\n      match,\n      childProps: reactElement.props\n    };\n\n    return viewItem;\n  }\n\n  getChildrenToRender(outletId: string, ionRouterOutlet: React.ReactElement, routeInfo: RouteInfo) {\n    const viewItems = this.getViewItemsForOutlet(outletId);\n\n    // Sync latest routes with viewItems\n    React.Children.forEach(ionRouterOutlet.props.children, (child: React.ReactElement) => {\n      const viewItem = viewItems.find(v => {\n        return matchComponent(child, v.routeData.childProps.path || v.routeData.childProps.from);\n      });\n      if (viewItem) {\n        viewItem.reactElement = child;\n      }\n    });\n\n    const children = viewItems.map(viewItem => {\n\n      let clonedChild;\n      if (viewItem.ionRoute && !viewItem.disableIonPageManagement) {\n        clonedChild = (\n          <ViewLifeCycleManager key={`view-${viewItem.id}`} mount={viewItem.mount} removeView={() => this.remove(viewItem)}>\n            {React.cloneElement(viewItem.reactElement, {\n              computedMatch: viewItem.routeData.match\n            })}\n          </ViewLifeCycleManager>\n        );\n      } else {\n        const match = matchComponent(viewItem.reactElement, routeInfo.pathname);\n        clonedChild = (\n          <ViewLifeCycleManager key={`view-${viewItem.id}`} mount={viewItem.mount} removeView={() => this.remove(viewItem)}>\n            {React.cloneElement(viewItem.reactElement, {\n              computedMatch: viewItem.routeData.match\n            })}\n          </ViewLifeCycleManager>\n        );\n\n        if (!match && viewItem.routeData.match) {\n          viewItem.routeData.match = undefined;\n          viewItem.mount = false;\n        }\n      }\n\n      return clonedChild;\n    });\n    return children;\n  }\n\n  findViewItemByRouteInfo(routeInfo: RouteInfo, outletId?: string) {\n    const { viewItem, match } = this.findViewItemByPath(routeInfo.pathname, outletId);\n    if (viewItem && match) {\n      viewItem.routeData.match = match;\n    }\n    return viewItem;\n  }\n\n  findLeavingViewItemByRouteInfo(routeInfo: RouteInfo, outletId?: string) {\n    const { viewItem } = this.findViewItemByPath(routeInfo.lastPathname!, outletId, false, true);\n    return viewItem;\n  }\n\n  getViewItemForTransition(pathname: string) {\n    const { viewItem } = this.findViewItemByPath(pathname, undefined, true, true);\n    return viewItem;\n  }\n\n  private findViewItemByPath(pathname: string, outletId?: string, forceExact?: boolean, mustBeIonRoute?: boolean) {\n\n    let viewItem: ViewItem | undefined;\n    let match: ReturnType<typeof matchPath> | undefined;\n    let viewStack: ViewItem[];\n\n    if (outletId) {\n      viewStack = this.getViewItemsForOutlet(outletId);\n      viewStack.some(matchView);\n      if (!viewItem) {\n        viewStack.some(matchDefaultRoute);\n      }\n    } else {\n      const viewItems = this.getAllViewItems();\n      viewItems.some(matchView);\n      if (!viewItem) {\n        viewItems.some(matchDefaultRoute);\n      }\n    }\n\n    return { viewItem, match };\n\n    function matchView(v: ViewItem) {\n      if (mustBeIonRoute && !v.ionRoute) {\n        return false;\n      }\n      const matchProps = {\n        exact: forceExact ? true : v.routeData.childProps.exact,\n        path: v.routeData.childProps.path || v.routeData.childProps.from,\n        component: v.routeData.childProps.component\n      };\n      const myMatch = matchPath(pathname, matchProps);\n      if (myMatch) {\n        viewItem = v;\n        match = myMatch;\n        return true;\n      }\n      return false;\n    }\n\n    function matchDefaultRoute(v: ViewItem) {\n      // try to find a route that doesn't have a path or from prop, that will be our default route\n      if (!v.routeData.childProps.path && !v.routeData.childProps.from) {\n        match = {\n          path: pathname,\n          url: pathname,\n          isExact: true,\n          params: {}\n        };\n        viewItem = v;\n        return true;\n      }\n      return false;\n    }\n\n  }\n\n}\n\nfunction matchComponent(node: React.ReactElement, pathname: string, forceExact?: boolean) {\n  const matchProps = {\n    exact: forceExact ? true : node.props.exact,\n    path: node.props.path || node.props.from,\n    component: node.props.component\n  };\n  const match = matchPath(pathname, matchProps);\n\n  return match;\n}\n","export function clonePageElement(leavingViewHtml: string | HTMLElement) {\n  let html: string;\n  if (typeof leavingViewHtml === 'string') {\n    html = leavingViewHtml;\n  } else {\n    html = leavingViewHtml.outerHTML;\n  }\n  if (document) {\n    const newEl = document.createElement('div');\n    newEl.innerHTML = html;\n    newEl.style.zIndex = '';\n    // Remove an existing back button so the new element doesn't get two of them\n    const ionBackButton = newEl.getElementsByTagName('ion-back-button');\n    if (ionBackButton[0]) {\n      ionBackButton[0].remove();\n    }\n    return newEl.firstChild as HTMLElement;\n  }\n  return undefined;\n}\n","import {\n  RouteInfo,\n  RouteManagerContext,\n  StackContext,\n  StackContextState,\n  ViewItem,\n  generateId,\n  getConfig\n} from '@ionic/react';\nimport React from 'react';\nimport { matchPath } from 'react-router-dom';\n\nimport { clonePageElement } from './clonePageElement';\n\ninterface StackManagerProps {\n  routeInfo: RouteInfo;\n}\n\ninterface StackManagerState { }\n\nexport class StackManager extends React.PureComponent<StackManagerProps, StackManagerState> {\n  id: string;\n  context!: React.ContextType<typeof RouteManagerContext>;\n  ionRouterOutlet?: React.ReactElement;\n  routerOutletElement: HTMLIonRouterOutletElement | undefined;\n\n  stackContextValue: StackContextState = {\n    registerIonPage: this.registerIonPage.bind(this),\n    isInOutlet: () => true\n  };\n\n  constructor(props: StackManagerProps) {\n    super(props);\n    this.registerIonPage = this.registerIonPage.bind(this);\n    this.transitionPage = this.transitionPage.bind(this);\n    this.handlePageTransition = this.handlePageTransition.bind(this);\n    this.id = generateId('routerOutlet');\n  }\n\n  componentDidMount() {\n    if (this.routerOutletElement) {\n      this.setupRouterOutlet(this.routerOutletElement);\n      // console.log(`SM Mount - ${this.routerOutletElement.id} (${this.id})`);\n      this.handlePageTransition(this.props.routeInfo);\n    }\n  }\n\n  componentDidUpdate(prevProps: StackManagerProps) {\n    if (this.props.routeInfo.pathname !== prevProps.routeInfo.pathname) {\n      this.handlePageTransition(this.props.routeInfo);\n    }\n  }\n\n  componentWillUnmount() {\n    // console.log(`SM UNMount - ${(this.routerOutletElement?.id as any).id} (${this.id})`);\n    this.context.clearOutlet(this.id);\n  }\n\n  async handlePageTransition(routeInfo: RouteInfo) {\n\n    // If routerOutlet isn't quite ready, give it another try in a moment\n    if (!this.routerOutletElement || !this.routerOutletElement.commit) {\n      setTimeout(() => this.handlePageTransition(routeInfo), 10);\n    } else {\n      let enteringViewItem = this.context.findViewItemByRouteInfo(routeInfo, this.id);\n      const leavingViewItem = this.context.findLeavingViewItemByRouteInfo(routeInfo, this.id);\n\n      if (!(routeInfo.routeAction === 'push' && routeInfo.routeDirection === 'forward')) {\n        const shouldLeavingViewBeRemoved = routeInfo.routeDirection !== 'none' && leavingViewItem && (enteringViewItem !== leavingViewItem);\n        if (shouldLeavingViewBeRemoved) {\n          leavingViewItem!.mount = false;\n        }\n      }\n\n      if (leavingViewItem && routeInfo.routeOptions?.unmount) {\n        leavingViewItem.mount = false;\n      }\n\n      const enteringRoute = matchRoute(this.ionRouterOutlet?.props.children, routeInfo) as React.ReactElement;\n      if (enteringViewItem) {\n        enteringViewItem.reactElement = enteringRoute;\n      }\n      if (!enteringViewItem) {\n        if (enteringRoute) {\n          enteringViewItem = this.context.createViewItem(this.id, enteringRoute, routeInfo);\n          this.context.addViewItem(enteringViewItem);\n        }\n      }\n      if (enteringViewItem && enteringViewItem.ionPageElement) {\n        this.transitionPage(routeInfo, enteringViewItem, leavingViewItem);\n      } else if (leavingViewItem && !enteringRoute && !enteringViewItem) {\n        // If we have a leavingView but no entering view/route, we are probably leaving to\n        // another outlet, so hide this leavingView. We do it in a timeout to give time for a\n        // transition to finish.\n        setTimeout(() => {\n          if (leavingViewItem.ionPageElement) {\n            leavingViewItem.ionPageElement.classList.add('ion-page-hidden');\n            leavingViewItem.ionPageElement.setAttribute('aria-hidden', 'true');\n          }\n        }, 250);\n      }\n\n      this.forceUpdate();\n    }\n  }\n\n  registerIonPage(page: HTMLElement, routeInfo: RouteInfo) {\n    const foundView = this.context.findViewItemByRouteInfo(routeInfo, this.id);\n    if (foundView) {\n      foundView.ionPageElement = page;\n      foundView.ionRoute = true;\n    }\n    this.handlePageTransition(routeInfo);\n  }\n\n  async setupRouterOutlet(routerOutlet: HTMLIonRouterOutletElement) {\n\n    const canStart = () => {\n      const config = getConfig();\n      const swipeEnabled = config && config.get('swipeBackEnabled', routerOutlet.mode === 'ios');\n      if (swipeEnabled) {\n        return this.context.canGoBack();\n      } else {\n        return false;\n      }\n    };\n\n    const onStart = () => {\n      this.context.goBack();\n    };\n    routerOutlet.swipeHandler = {\n      canStart,\n      onStart,\n      onEnd: _shouldContinue => true\n    };\n  }\n\n  async transitionPage(routeInfo: RouteInfo, enteringViewItem: ViewItem, leavingViewItem?: ViewItem) {\n\n    const routerOutlet = this.routerOutletElement!;\n\n    const direction = (routeInfo.routeDirection === 'none' || routeInfo.routeDirection === 'root')\n      ? undefined\n      : routeInfo.routeDirection;\n\n    if (enteringViewItem && enteringViewItem.ionPageElement && this.routerOutletElement) {\n      if (leavingViewItem && leavingViewItem.ionPageElement && (enteringViewItem === leavingViewItem)) {\n        // If a page is transitioning to another version of itself\n        // we clone it so we can have an animation to show\n\n        const match = matchComponent(leavingViewItem.reactElement, routeInfo.pathname, true);\n        if (match) {\n          const newLeavingElement = clonePageElement(leavingViewItem.ionPageElement.outerHTML);\n          if (newLeavingElement) {\n            this.routerOutletElement.appendChild(newLeavingElement);\n            await runCommit(enteringViewItem.ionPageElement, newLeavingElement);\n            this.routerOutletElement.removeChild(newLeavingElement);\n          }\n        } else {\n          await runCommit(enteringViewItem.ionPageElement, undefined);\n        }\n      } else {\n        await runCommit(enteringViewItem.ionPageElement, leavingViewItem?.ionPageElement);\n        if (leavingViewItem && leavingViewItem.ionPageElement) {\n          leavingViewItem.ionPageElement.classList.add('ion-page-hidden');\n          leavingViewItem.ionPageElement.setAttribute('aria-hidden', 'true');\n        }\n      }\n    }\n\n    async function runCommit(enteringEl: HTMLElement, leavingEl?: HTMLElement) {\n      enteringEl.classList.add('ion-page');\n      enteringEl.classList.add('ion-page-invisible');\n\n      await routerOutlet.commit(enteringEl, leavingEl, {\n        deepWait: true,\n        duration: direction === undefined ? 0 : undefined,\n        direction: direction as any,\n        showGoBack: direction === 'forward',\n        progressAnimation: false,\n        animationBuilder: routeInfo.routeAnimation\n      });\n    }\n  }\n\n  render() {\n    const { children } = this.props;\n    const ionRouterOutlet = React.Children.only(children) as React.ReactElement;\n    this.ionRouterOutlet = ionRouterOutlet;\n\n    const components = this.context.getChildrenToRender(\n      this.id,\n      this.ionRouterOutlet,\n      this.props.routeInfo,\n      () => {\n        this.forceUpdate();\n      });\n\n    return (\n      <StackContext.Provider value={this.stackContextValue}>\n        {React.cloneElement(ionRouterOutlet as any, {\n          ref: (node: HTMLIonRouterOutletElement) => {\n            if (ionRouterOutlet.props.setRef) {\n              ionRouterOutlet.props.setRef(node);\n            }\n            if (ionRouterOutlet.props.forwardedRef) {\n              ionRouterOutlet.props.forwardedRef.current = node;\n            }\n            this.routerOutletElement = node;\n            const { ref } = ionRouterOutlet as any;\n            if (typeof ref === 'function') {\n              ref(node);\n            }\n          }\n        },\n          components\n        )}\n      </StackContext.Provider>\n    );\n  }\n\n  static get contextType() {\n    return RouteManagerContext;\n  }\n}\n\nexport default StackManager;\n\nfunction matchRoute(node: React.ReactNode, routeInfo: RouteInfo) {\n  let matchedNode: React.ReactNode;\n  React.Children.forEach(node as React.ReactElement, (child: React.ReactElement) => {\n    const matchProps = {\n      exact: child.props.exact,\n      path: child.props.path || child.props.from,\n      component: child.props.component\n    };\n    const match = matchPath(routeInfo.pathname, matchProps);\n    if (match) {\n      matchedNode = child;\n    }\n  });\n\n  if (matchedNode) {\n    return matchedNode;\n  }\n  // If we haven't found a node\n  // try to find one that doesn't have a path or from prop, that will be our not found route\n  React.Children.forEach(node as React.ReactElement, (child: React.ReactElement) => {\n    if (!(child.props.path || child.props.from)) {\n      matchedNode = child;\n    }\n  });\n\n  return matchedNode;\n}\n\nfunction matchComponent(node: React.ReactElement, pathname: string, forceExact?: boolean) {\n  const matchProps = {\n    exact: forceExact ? true : node.props.exact,\n    path: node.props.path || node.props.from,\n    component: node.props.component\n  };\n  const match = matchPath(pathname, matchProps);\n\n  return match;\n}\n","import { AnimationBuilder } from '@ionic/core';\nimport {\n  LocationHistory,\n  NavManager,\n  RouteAction,\n  RouteInfo,\n  RouteManagerContext,\n  RouteManagerContextState,\n  RouterDirection,\n  ViewItem,\n  generateId,\n  getConfig\n} from '@ionic/react';\nimport { Action as HistoryAction, Location as HistoryLocation } from 'history';\nimport React from 'react';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\n\nimport { IonRouteInner } from './IonRouteInner';\nimport { ReactRouterViewStack } from './ReactRouterViewStack';\nimport StackManager from './StackManager';\n\nexport interface LocationState {\n  direction?: RouterDirection;\n  routerOptions?: { as?: string, unmount?: boolean; };\n}\n\ninterface IonRouteProps extends RouteComponentProps<{}, {}, LocationState> {\n  registerHistoryListener: (cb: (location: HistoryLocation<any>, action: HistoryAction) => void) => void;\n}\n\ninterface IonRouteState {\n  routeInfo: RouteInfo;\n}\n\nclass IonRouterInner extends React.PureComponent<IonRouteProps, IonRouteState> {\n  currentTab?: string;\n  exitViewFromOtherOutletHandlers: ((pathname: string) => ViewItem | undefined)[] = [];\n  incomingRouteParams?: Partial<RouteInfo>;\n  locationHistory = new LocationHistory();\n  viewStack = new ReactRouterViewStack();\n  routeMangerContextState: RouteManagerContextState = {\n    canGoBack: () => this.locationHistory.canGoBack(),\n    clearOutlet: this.viewStack.clear,\n    getViewItemForTransition: this.viewStack.getViewItemForTransition,\n    getChildrenToRender: this.viewStack.getChildrenToRender,\n    goBack: () => this.handleNavigateBack(),\n    createViewItem: this.viewStack.createViewItem,\n    findViewItemByRouteInfo: this.viewStack.findViewItemByRouteInfo,\n    findLeavingViewItemByRouteInfo: this.viewStack.findLeavingViewItemByRouteInfo,\n    addViewItem: this.viewStack.add,\n    unMountViewItem: this.viewStack.remove\n  };\n\n  constructor(props: IonRouteProps) {\n    super(props);\n\n    const routeInfo = {\n      id: generateId('routeInfo'),\n      pathname: this.props.location.pathname,\n      search: this.props.location.search\n    };\n\n    this.locationHistory.add(routeInfo);\n    this.handleChangeTab = this.handleChangeTab.bind(this);\n    this.handleResetTab = this.handleResetTab.bind(this);\n    this.handleNavigate = this.handleNavigate.bind(this);\n    this.handleNavigateBack = this.handleNavigateBack.bind(this);\n    this.props.registerHistoryListener(this.handleHistoryChange.bind(this));\n    this.handleSetCurrentTab = this.handleSetCurrentTab.bind(this);\n\n    this.state = {\n      routeInfo\n    };\n  }\n\n  handleChangeTab(tab: string, path: string, routeOptions?: any) {\n    const routeInfo = this.locationHistory.getCurrentRouteInfoForTab(tab);\n    const [pathname, search] = path.split('?');\n    if (routeInfo) {\n      this.incomingRouteParams = { ...routeInfo, routeAction: 'push', routeDirection: 'none' };\n      if (routeInfo.pathname === pathname) {\n        this.incomingRouteParams.routeOptions = routeOptions;\n        this.props.history.push(routeInfo.pathname + (routeInfo.search || ''));\n      } else {\n        this.incomingRouteParams.pathname = pathname;\n        this.incomingRouteParams.search = search ? '?' + search : undefined;\n        this.incomingRouteParams.routeOptions = routeOptions;\n        this.props.history.push(pathname + (search ? '?' + search : ''));\n      }\n    } else {\n      this.handleNavigate(pathname, 'push', 'none', undefined, routeOptions, tab);\n    }\n  }\n\n  handleHistoryChange(location: HistoryLocation<LocationState>, action: HistoryAction) {\n    let leavingLocationInfo: RouteInfo;\n    if (this.incomingRouteParams) {\n      if (this.incomingRouteParams.routeAction === 'replace') {\n        leavingLocationInfo = this.locationHistory.previous();\n      } else {\n        leavingLocationInfo = this.locationHistory.current();\n      }\n    } else if (action === 'REPLACE') {\n      leavingLocationInfo = this.locationHistory.previous();\n    } else {\n      leavingLocationInfo = this.locationHistory.current();\n    }\n\n    const leavingUrl = leavingLocationInfo.pathname + leavingLocationInfo.search;\n    if (leavingUrl !== location.pathname) {\n      if (!this.incomingRouteParams) {\n        if (action === 'REPLACE') {\n          this.incomingRouteParams = {\n            routeAction: 'replace',\n            routeDirection: 'none',\n            tab: this.currentTab\n          };\n        }\n        if (action === 'POP') {\n          const ri = this.locationHistory.current();\n          if (ri && ri.pushedByRoute) {\n            const prevInfo = this.locationHistory.findLastLocation(ri);\n            this.incomingRouteParams = { ...prevInfo, routeAction: 'pop', routeDirection: 'back' };\n          } else {\n            const direction = 'none';\n            this.incomingRouteParams = {\n              routeAction: 'pop',\n              routeDirection: direction,\n              tab: this.currentTab\n            };\n          }\n        }\n        if (!this.incomingRouteParams) {\n          this.incomingRouteParams = {\n            routeAction: 'push',\n            routeDirection: location.state?.direction || 'forward',\n            routeOptions: location.state?.routerOptions,\n            tab: this.currentTab\n          };\n        }\n      }\n\n      let routeInfo: RouteInfo;\n\n      if (this.incomingRouteParams?.id) {\n        routeInfo = {\n          ...this.incomingRouteParams as RouteInfo,\n          lastPathname: leavingLocationInfo.pathname\n        };\n        this.locationHistory.add(routeInfo);\n      } else {\n        const isPushed = (this.incomingRouteParams.routeAction === 'push' && this.incomingRouteParams.routeDirection === 'forward');\n        routeInfo = {\n          id: generateId('routeInfo'),\n          ...this.incomingRouteParams,\n          lastPathname: leavingLocationInfo.pathname,\n          pathname: location.pathname,\n          search: location.search,\n          params: this.props.match.params\n        };\n        if (isPushed) {\n          routeInfo.tab = leavingLocationInfo.tab;\n          routeInfo.pushedByRoute = leavingLocationInfo.pathname;\n        } else if (routeInfo.routeAction === 'pop') {\n          const r = this.locationHistory.findLastLocation(routeInfo);\n          routeInfo.pushedByRoute = r?.pushedByRoute;\n        } else if (routeInfo.routeAction === 'push' && routeInfo.tab !== leavingLocationInfo.tab) {\n          // If we are switching tabs grab the last route info for the tab and use its pushedByRoute\n          const lastRoute = this.locationHistory.getCurrentRouteInfoForTab(routeInfo.tab);\n          routeInfo.pushedByRoute = lastRoute?.pushedByRoute;\n        } else if (routeInfo.routeAction === 'replace') {\n          // Make sure to set the lastPathname, etc.. to the current route so the page transitions out\n          const currentRouteInfo = this.locationHistory.current();\n          routeInfo.lastPathname = currentRouteInfo?.pathname || routeInfo.lastPathname;\n          routeInfo.pushedByRoute = currentRouteInfo?.pushedByRoute || routeInfo.pushedByRoute;\n          routeInfo.routeDirection = currentRouteInfo?.routeDirection || routeInfo.routeDirection;\n          routeInfo.routeAnimation = currentRouteInfo?.routeAnimation || routeInfo.routeAnimation;\n        }\n\n        this.locationHistory.add(routeInfo);\n      }\n\n      this.setState({\n        routeInfo\n      });\n    }\n\n    this.incomingRouteParams = undefined;\n  }\n\n  handleNavigate(path: string, routeAction: RouteAction, routeDirection?: RouterDirection, routeAnimation?: AnimationBuilder, routeOptions?: any, tab?: string) {\n    this.incomingRouteParams = {\n      routeAction,\n      routeDirection,\n      routeOptions,\n      routeAnimation,\n      tab\n    };\n\n    if (routeAction === 'push') {\n      this.props.history.push(path);\n    } else {\n      this.props.history.replace(path);\n    }\n  }\n\n  handleNavigateBack(defaultHref: string | RouteInfo = '/', routeAnimation?: AnimationBuilder) {\n    const config = getConfig();\n    defaultHref = defaultHref ? defaultHref : config && config.get('backButtonDefaultHref' as any);\n    const routeInfo = this.locationHistory.current();\n    if (routeInfo && routeInfo.pushedByRoute) {\n      const prevInfo = this.locationHistory.findLastLocation(routeInfo);\n      if (prevInfo) {\n        this.incomingRouteParams = { ...prevInfo, routeAction: 'pop', routeDirection: 'back', routeAnimation: routeAnimation || routeInfo.routeAnimation };\n        if (routeInfo.lastPathname === routeInfo.pushedByRoute) {\n          this.props.history.goBack();\n        } else {\n          this.props.history.replace(prevInfo.pathname + (prevInfo.search || ''));\n        }\n      } else {\n        this.handleNavigate(defaultHref as string, 'pop', 'back');\n      }\n    } else {\n      this.handleNavigate(defaultHref as string, 'pop', 'back');\n    }\n  }\n\n  handleResetTab(tab: string, originalHref: string, originalRouteOptions: any) {\n    const routeInfo = this.locationHistory.getFirstRouteInfoForTab(tab);\n    if (routeInfo) {\n      const newRouteInfo = { ...routeInfo };\n      newRouteInfo.pathname = originalHref;\n      newRouteInfo.routeOptions = originalRouteOptions;\n      this.incomingRouteParams = { ...newRouteInfo, routeAction: 'pop', routeDirection: 'back' };\n      this.props.history.push(newRouteInfo.pathname + (newRouteInfo.search || ''));\n    }\n  }\n\n  handleSetCurrentTab(tab: string) {\n    this.currentTab = tab;\n    const ri = { ...this.locationHistory.current() };\n    if (ri.tab !== tab) {\n      ri.tab = tab;\n      this.locationHistory.update(ri);\n    }\n  }\n\n  render() {\n    return (\n      <RouteManagerContext.Provider\n        value={this.routeMangerContextState}\n      >\n        <NavManager\n          ionRoute={IonRouteInner}\n          ionRedirect={{}}\n          stackManager={StackManager}\n          routeInfo={this.state.routeInfo!}\n          onNavigateBack={this.handleNavigateBack}\n          onNavigate={this.handleNavigate}\n          onSetCurrentTab={this.handleSetCurrentTab}\n          onChangeTab={this.handleChangeTab}\n          onResetTab={this.handleResetTab}\n          locationHistory={this.locationHistory}\n        >\n          {this.props.children}\n        </NavManager>\n      </RouteManagerContext.Provider>\n    );\n  }\n}\n\nexport const IonRouter = withRouter(IonRouterInner);\nIonRouter.displayName = 'IonRouter';\n","import { Action as HistoryAction, History, Location as HistoryLocation, createBrowserHistory as createHistory } from 'history';\nimport React from 'react';\nimport { BrowserRouterProps, Router } from 'react-router-dom';\n\nimport { IonRouter } from './IonRouter';\n\ninterface IonReactRouterProps<THistoryLocationState = History.PoorMansUnknown> extends BrowserRouterProps {\n  history?: History<THistoryLocationState>;\n}\n\nexport class IonReactRouter extends React.Component<IonReactRouterProps> {\n\n  historyListenHandler?: ((location: HistoryLocation, action: HistoryAction) => void);\n  history: History<History.PoorMansUnknown>;\n\n  constructor(props: IonReactRouterProps) {\n    super(props);\n    const { history, ...rest } = props;\n    this.history = history || createHistory(rest);\n    this.history.listen(this.handleHistoryChange.bind(this));\n    this.registerHistoryListener = this.registerHistoryListener.bind(this);\n  }\n\n  handleHistoryChange(location: HistoryLocation, action: HistoryAction) {\n    if (this.historyListenHandler) {\n      this.historyListenHandler(location, action);\n    }\n  }\n\n  registerHistoryListener(cb: (location: HistoryLocation, action: HistoryAction) => void) {\n    this.historyListenHandler = cb;\n  }\n\n  render() {\n    const { children, ...props } = this.props;\n    return (\n      <Router history={this.history} {...props}>\n        <IonRouter registerHistoryListener={this.registerHistoryListener}>{children}</IonRouter>\n      </Router>\n    );\n  }\n}\n","import { Action as HistoryAction, Location as HistoryLocation, MemoryHistory } from 'history';\nimport React from 'react';\nimport { MemoryRouterProps, Router } from 'react-router';\n\nimport { IonRouter, LocationState } from './IonRouter';\n\ninterface IonReactMemoryRouterProps extends MemoryRouterProps {\n  history: MemoryHistory<LocationState>;\n}\n\nexport class IonReactMemoryRouter extends React.Component<IonReactMemoryRouterProps> {\n  history: MemoryHistory<LocationState>;\n  historyListenHandler?: ((location: HistoryLocation, action: HistoryAction) => void);\n\n  constructor(props: IonReactMemoryRouterProps) {\n    super(props);\n    this.history = props.history;\n    this.history.listen(this.handleHistoryChange.bind(this));\n    this.registerHistoryListener = this.registerHistoryListener.bind(this);\n  }\n\n  handleHistoryChange(location: HistoryLocation, action: HistoryAction) {\n    if (this.historyListenHandler) {\n      this.historyListenHandler(location, action);\n    }\n  }\n\n  registerHistoryListener(cb: (location: HistoryLocation, action: HistoryAction) => void) {\n    this.historyListenHandler = cb;\n  }\n\n  render() {\n    const { children, ...props } = this.props;\n    return (\n      <Router {...props}>\n        <IonRouter registerHistoryListener={this.registerHistoryListener}>{children}</IonRouter>\n      </Router>\n    );\n  }\n}\n","import { Action as HistoryAction, History, Location as HistoryLocation, createHashHistory as createHistory } from 'history';\nimport React from 'react';\nimport { BrowserRouterProps, Router } from 'react-router-dom';\n\nimport { IonRouter } from './IonRouter';\n\ninterface IonReactHashRouterProps<THistoryLocationState = History.PoorMansUnknown> extends BrowserRouterProps {\n  history?: History<THistoryLocationState>;\n}\n\nexport class IonReactHashRouter extends React.Component<IonReactHashRouterProps> {\n  history: History<History.PoorMansUnknown>;\n  historyListenHandler?: ((location: HistoryLocation, action: HistoryAction) => void);\n\n  constructor(props: IonReactHashRouterProps) {\n    super(props);\n    const { history, ...rest } = props;\n    this.history = history || createHistory(rest);\n    this.history.listen(this.handleHistoryChange.bind(this));\n    this.registerHistoryListener = this.registerHistoryListener.bind(this);\n  }\n\n  handleHistoryChange(location: HistoryLocation, action: HistoryAction) {\n    if (this.historyListenHandler) {\n      this.historyListenHandler(location, action);\n    }\n  }\n\n  registerHistoryListener(cb: (location: HistoryLocation, action: HistoryAction) => void) {\n    this.historyListenHandler = cb;\n  }\n\n  render() {\n    const { children, ...props } = this.props;\n    return (\n      <Router history={this.history} {...props}>\n        <IonRouter registerHistoryListener={this.registerHistoryListener}>{children}</IonRouter>\n      </Router>\n    );\n  }\n}\n"],"names":["Route","ViewStacks","generateId","matchPath","IonRoute","ViewLifeCycleManager","getConfig","matchComponent","StackContext","RouteManagerContext","LocationHistory","NavManager","withRouter","history","createHistory","Router"],"mappings":"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"}